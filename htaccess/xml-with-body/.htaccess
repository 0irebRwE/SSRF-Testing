# Set minimal xml response body
ErrorDocument 300 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'
ErrorDocument 301 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'
ErrorDocument 302 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'
ErrorDocument 303 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'
ErrorDocument 307 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'
ErrorDocument 308 '<?xml version="1.0" encoding="UTF-8"?><note><to>Tove</to><from>Jani</from><heading>Title</heading><body>Test</body></note>'

# 300 with response body
# http://ssrf.localdomain.pw/xml-with-body/300-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/300-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 300-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 300-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=300,NC]

# 301 with response body
# http://ssrf.localdomain.pw/xml-with-body/301-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/301-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 301-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 301-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=301,NC]

# 302 with response body
# http://ssrf.localdomain.pw/xml-with-body/302-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/302-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 302-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 302-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=302,NC]

# 303 with response body
# http://ssrf.localdomain.pw/xml-with-body/303-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/303-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 303-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 303-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=303,NC]

# 307 with response body
# http://ssrf.localdomain.pw/xml-with-body/307-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/307-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 307-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 307-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=307,NC]

# 308 with response body
# http://ssrf.localdomain.pw/xml-with-body/308-http-169.254.169.254:80-.x.xml
# http://ssrf.localdomain.pw/xml-with-body/308-http-169.254.169.254:80-test/.x.xml
RewriteEngine on
RewriteCond %{REQUEST_URI} 308-([^/-]*)-([^/-]*)-(.*).x.xml$
RewriteRule 308-([^/-]*)-([^/-]*)-(.*).x.xml$ $1://$2/$3 [L,R=308,NC]

# Always set the Content-Type header text/xml
Header always set Content-Type text/xml
